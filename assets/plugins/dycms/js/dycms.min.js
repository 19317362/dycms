/*! Copyright (c) 2018 Abu Dzakiyyah (https://abu.dzakiyyah.com)
 * Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 *
 * Version: 1.0
 *
 */
$(document).ajaxStart(function(){Pace.restart()});contentAutoHeight({element:".mainContent",scroll:true,drag:false,substract:170,plugin:"slimScroll"});function contentAutoHeight(h){var d=h.element;var a=h.scroll;var e=h.drag;var b=h.substract;var g=h.plugin;var c="";var f=$(document).height()-b;if(g==="niceScroll"){$(d).attr("style","height:"+f+"px;");if(e===true){c={touchbehavior:true,usetransition:true,hwacceleration:true}}else{c=""}if(a===true){$(d).niceScroll(c)}}else{if(g==="slimScroll"){$(d).slimScroll({height:f,size:"3px"})}else{console.log("No Plugin")}}}function getNext(){var a=$(".mainNav>ul>li.active").next();a.find("a").click()}function getPrev(){var a=$(".mainNav>ul>li.active").prev();a.find("a").click()}function getTabData(b){var a=JSON.parse(localStorage[b]===undefined?null:localStorage[b]);return a}function saveTabData(b,c){var a=JSON.parse(localStorage[b]===undefined?JSON.stringify([]):localStorage[b]);a.push(c);localStorage.setItem(b,JSON.stringify(a))}function findTabData(c,e,d){var a=JSON.parse(localStorage[c]);for(var b=0;b<a.length;b++){if(d===a[b][e]){return a[b]}}}function updateTabData(c,e,d){var a=JSON.parse(localStorage[c]);for(var b=0;b<a.length;b++){if(d===a[b].tabIndex){a[b][e]="active"}else{a[b][e]=""}}localStorage.setItem(c,JSON.stringify(a))}function deleteTabData(c,e,d){var b=JSON.parse(localStorage[c]===undefined?JSON.stringify([]):localStorage[c]),a=b.filter(function(f){return f[e]!==d});localStorage.setItem(c,JSON.stringify(a))}function bindCloseTab(){$("span.closeTab").click(function(){var c=$(this).parents("li a"),e=c[0].hash,a=e.split("#"),d=$(this).parents("li.active").prev(),b=$(this).parents("li.active").next();$(this).parents("li").remove();$(e).remove();deleteTabData("mainTabs","tabId",a[1]);if(b.length===0){d.find("a").click()}else{b.find("a").click()}})}function loadURL(a,b,c){$.get(a,c,function(d){$(b).html(d)}).fail(function(e){var d='<div class="error-page"><h2 class="headline text-yellow" style="margin-top: -25px; margin-bottom: 0px;"> 404</h2><div class="error-content"><h3><i class="fa fa-warning text-yellow"></i> Oops! Terjadi Kesalahan...</h3><p>Sistem tidak dapat menemukan halaman yang anda akses, silahkan menghubungi Administrator untuk masalah ini.</p></div></div>';$(b).html(d)})}function restoreSettings(){var a=getTabData("mainTabs"),b=getTabData("sidebarSetting");if(a!==null){restoreTabs(a)}else{var c={tabIndex:0,tabId:"home",tabUrl:"pages/home.html",tabTitle:"Beranda",tabIcon:"fa fa-home",tabDesc:"Selamat Datang Admin",tabStatus:"active"};saveTabData("mainTabs",c);tabTrigger("a[href='#home']");$("a[href='#home']").tab("show");loadURL(c.tabUrl,"#"+c.tabId+"Content")}if(b!==null){if(b.mode==="sidebar-collapse"){$("body").addClass(b.mode)}else{$("body").removeClass(b.mode)}}}function restoreTabs(e){var d=$(".mainNav ul.nav"),f=$(".mainNav div.tab-content"),h="",c="",b="",g="",a="";$.each(e,function(j,k){if(k.tabId!=="home"){var i=$(".subMenu[data-id='"+k.tabId+"']"),l=i.parents("li.treeview").find("span").html(),m=i.parents("li.treeview").find("i").attr("class");h='<li data-index="'+k.tabIndex+'"><a href="#'+k.tabId+'" data-toggle="tab"><i class="'+k.tabIcon+'"></i> '+k.tabTitle+' <span class="closeTab"><i class="fa fa-times-circle"></i></span></a></li>';c='<div class="tab-pane" id="'+k.tabId+'"><section class="content-header"><h1>'+l+"<small>"+k.tabDesc+'</small></h1><ol class="breadcrumb"><li><a><i class="'+m+'"></i> '+l+'</a></li><li class="active">'+k.tabTitle+'</li></ol></section><section id="'+k.tabId+'Content" class="content text-justify mainContent"></section></div>'}d.append(h);f.append(c);if(k.tabStatus==="active"){b=k.tabId;g=k.tabUrl}else{a='<div class="error-page"><div class="error-content text-center" style="margin-left: 0px;"><h3><i class="fa fa-info-circle text-primary"></i> Mode penghemat daya aktif...</h3><p>Sebaiknya anda tidak merefresh browser, Silahkan tekan tombol reload untuk memuat halaman<br><br><button class="btn btn-primary" onclick="restoreContent(\''+k.tabId+"','"+k.tabUrl+'\');" data-toggle="tooltip" title="Tekan untuk reload halaman" data-container=".tab-content" ><i class="fa fa-spinner fa-spin"></i> Reload</button></p></div></div>';$("#"+k.tabId+"Content.mainContent").append(a)}tabTrigger("a[href='#"+k.tabId+"']");contentAutoHeight({element:"#"+k.tabId+"Content",scroll:true,drag:false,substract:170,plugin:"slimScroll"})});bindCloseTab();bindDynamicTab();$("a[href='#"+b+"']").tab("show");loadURL(g,"#"+b+"Content")}function restoreContent(b,a){contentAutoHeight({element:"#"+b+"Content",scroll:true,drag:false,substract:170,plugin:"slimScroll"});loadURL(a,"#"+b+"Content")}function buildTabs(a){var f=$(".mainNav>ul.nav"),h=$(".mainNav>div.tab-content"),k=$(a.parent[0]).find("i").attr("class"),d=$(a.parent[0]).find("span").html(),b=f.find("a[href='#"+a.id+"']"),e=f.find("li:last-child").attr("data-index"),i=parseInt(e)+1,g='<li data-index="'+i+'"><a href="#'+a.id+'" data-toggle="tab"><i class="'+a.icon+'"></i> '+a.title+' <span class="closeTab"><i class="fa fa-times-circle"></i></span></a></li>',c='<div class="tab-pane" id="'+a.id+'"></div>';navContentHeader='<section class="content-header"><h1>'+d+"<small>"+a.desc+'</small></h1><ol class="breadcrumb"><li><a><i class="'+k+'"></i> '+d+'</a></li><li class="active">'+a.title+'</li></ol></section><section id="'+a.id+'Content" class="content text-justify mainContent"></section>';if(b.length<1){f.append(g);h.append(c);$("#"+a.id).append(navContentHeader);var j={tabIndex:i,tabId:a.id,tabUrl:a.url,tabTitle:a.title,tabIcon:a.icon,tabDesc:a.desc,tabStatus:""};saveTabData("mainTabs",j);bindCloseTab();contentAutoHeight({element:"#"+a.id+"Content",scroll:true,drag:false,substract:170,plugin:"slimScroll"});loadURL(a.url,"#"+a.id+"Content");bindDynamicTab();tabTrigger("a[href='#"+a.id+"']");return true}else{bindDynamicTab();return false}}function bindDynamicTab(){$(".draggable").draggable_nav({axis:"x"});$(".draggable").draggable({axis:"x",drag:function(f,g){var k=g.helper;var i=k.width();var j=k.parent().width();var a=0;if(i>j){a=-(i-j)}var c=k.height();var d=k.parent().height();var b=0;if(c>d){b=c-d}if(g.position.left>0){g.position.left=0}else{if(g.position.left<a){g.position.left=a}}if(g.position.top>0){g.position.top=0}else{if(g.position.top<b){g.position.top=b}}}})}function tabTrigger(a){$(a).on("shown.bs.tab",function(b){index=parseInt($(this).parent("li").attr("data-index"));updateTabData("mainTabs","tabStatus",index)})}function saveSettingSidebar(a,c){var b={mode:c};localStorage.setItem(a,JSON.stringify(b))}$(function(){restoreSettings();$(".sidebar-toggle").click(function(){if($("body").delay(300).hasClass("sidebar-collapse")){saveSettingSidebar("sidebarSetting","")}else{saveSettingSidebar("sidebarSetting","sidebar-collapse")}});$(".dropdown-menu li>.menu").slimScroll({height:"200px",size:"3px"});$(".subMenu").click(function(){var b={url:$(this).data("url"),id:$(this).data("id"),desc:$(this).data("desc"),parent:$(this).parents("li.treeview").find("a"),icon:$(this).find("i").attr("class"),title:$(this).find("span").html()};var d=buildTabs(b);var c=$('.mainNav>ul>li>a[href="#'+b.id+'"]'),a=parseInt(c.parent("li").attr("data-index"));c.tab("show");if(d===false){updateTabData("mainTabs","tabStatus",a)}})});